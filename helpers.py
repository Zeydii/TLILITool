import sys
import time
import threading
from termcolor import colored
import os
from colorama import Fore, Style, init

# ğŸŒ€ Spinner
class Spinner:
    busy = False
    delay = 0.1

    @staticmethod
    def spinning_cursor():
        while True:
            for cursor in '|/-\\':
                yield cursor

    def __init__(self, delay=None):
        self.spinner_generator = self.spinning_cursor()
        if delay and float(delay): self.delay = delay

    def spinner_task(self):
        while self.busy:
            sys.stdout.write(next(self.spinner_generator))
            sys.stdout.flush()
            time.sleep(self.delay)
            sys.stdout.write('\b')

    def __enter__(self):
        self.busy = True
        threading.Thread(target=self.spinner_task).start()

    def __exit__(self, exception, value, tb):
        self.busy = False
        time.sleep(self.delay)

# ğŸ¨ Color Print
init(autoreset=True)

def print_status(message, status="info"):
    colors = {
        "info": Fore.CYAN,
        "ok": Fore.GREEN,
        "warn": Fore.YELLOW,
        "fail": Fore.RED
    }
    color = colors.get(status, Fore.WHITE)
    print(f"{color}[{status.upper()}] {message}{Style.RESET_ALL}")

# ğŸ§  Banner
def show_banner():
    os.system('clear')
    banner = r"""

            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     
            â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     
               â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     
               â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     
               â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
               â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•   â•šâ•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•
                                                                              

        ```````````````````````````````;Ã½Ã¢Ã›HÃÃ€Å“â‚¬Ã°T``````````````````````````````````
        ```````````````````````````uÃƒÃ†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã–``````````````````````````````
        `````````````````````````gÃ†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†u```````````````````````````
        ```````````````````````Ã¯Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ãƒ``````````````````````````
        ``````````````````````Ã“Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Å’`````````````````````````
        ``````````````````````Ã…Ã†Ã·`Ã‘Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†m`ÃƒÃ†Å¾````````````````````````
        ``````````````````````Ã‹Ã†Ã·`Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†m`ÃƒÃ†Å“````````````````````````
        ``````````````````````Ã¾Ã†Q`pÃ†Ã†Ã‘ÃƒÃ›Ã¢Å Ã‹Ã†Ã†Ã†Ã†QmpÃ€MÃ†Ã†Ã†Ã¤`Ã†Ã†Â¸````````````````````````
        ```````````````````````Ã†Ã†`Â¶Â½````````Ã†Ã°````````Å’Ã¼`Ã†d`````````````````````````
        ``````````````````````````Ã†````````LÃ†Å’````````|Å“`Ã’``````````````````````````
        `````````````ÃµÃ†p`````````Ã†Ã†+``````Â²Ã†Ã†Ã†Ã†```````HÃ†;``````````ÃªÃ†Ã†Ã†u````````````
        ````````````Ã†Ã†Ã†Ã†Ã†Ã¥```````Ã†Ã†Ã†Ã†````Ã†Ã†8HkÃ¾Ã†â€¹```Â¤Ã†Ã†Ã†w````````Ã‡Ã†Ã†Ã†Ã†Ã†Ã†````````````
        ````````````Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†`````Ã´Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã‘``L``MÃ†Ã†Ã†Ã†Ã†Ã†Ã†Ã†``````7Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã²```````````
        ```````````Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†MÃ{``Â¨Ã‘Ã†Ã†Ã†Ã†Ã–``L```Ã†Ã†Ã†Ã†Ã†g```Â½Â®Ã‘Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†â€š``````````
        ```````````Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†`â€œ[``Â¤Ã†Ã†Ã†ÃµÂ¨Å ÃµÂ¸Ã†Ã†Ã†Ã†```Ã¢`fÃ†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã…RÃ‘Ã†Ã†Ã†Ã‡```````````
        ````````````````````Â¨&HÃ†Ã†Â­`Ã†`Â´`}Ã‹Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã¾```Ãt`Ã¾Ã†Ã†pÃ¹```````````````````````
        ```````````````````````````Ã†Ã†`Ã¤``````````Â³Vâ€¡â€Ã†R`````````````````````````````
        ```````````````````````````Ã†Ã†3````Â´``6â€œ``}r`Ã‹Ã†Ã½`````````````````````````````
        ````````````````````````Â²n`Ã¥Ã†Ã†T```â€¦``Oâ€“```Â¨MÃ†Ã‘``ÃœË†``````````````````````````
        ````````````Å“Å“Ã–[Â´Ë†umMÃ†Ã†Ã†Ã†Ã†Z`YÃ†Ã†Ã†Ã†Ã†Ã†Ã‚Ã¾ÃÅ’Ã†Ã†Ã†Ã†Ã†Å“``Ã†Ã†Ã†Ã†Ã†Ã†#{`````````````````````
        ``````````Â¨Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†â€```Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Â®```ÃŒÃ†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†```````````
        ```````````Ã–Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Å“``````````````````````````````Ã›Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†Ã†```````````
        ````````````Ã†Ã†Ã†Ã†Ã†Ã†Ãƒ````````````````````````````````````Â´â‚¬Ã†Ã†Ã†Ã†Ã†Ã†Ã†````````````
        ````````````ÃœÃ†Ã†Ã†Ã†`````````````````````````````````````````Ã–Ã†Ã†Ã†Ã†Ã†````````````
        ````````````````````````````````````````````````````````````#Ã‚Ã”`````````````


"""

    print(colored(banner, "red"))
    print(colored("         ğŸ”¥ TLILITool - Multi Protocol Scanner ğŸ”¥\n", "yellow"))

def extract_os_info(scanner, target):
    """
    Extracts OS guess and hostname from the nmap scanner result.
    """
    try:
        os_guess = "Unknown"
        hostname = "Unknown"

        if scanner[target].hostname():
            hostname = scanner[target].hostname()

        if "osmatch" in scanner[target]:
            if scanner[target]["osmatch"]:
                best_guess = scanner[target]["osmatch"][0]
                os_guess = f"{best_guess['name']} ({best_guess['accuracy']}% confidence)"

        return os_guess, hostname

    except Exception:
        return "Unknown", "Unknown"

